<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Calculadora Laboral Integrada | Tu Abogado Laboral</title>
    <link rel="icon" href="img/favicon.webp" type="image/webp" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link rel="stylesheet" href="css/style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700;900&family=Montserrat:wght@400;700;900&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      /* --- ESTILOS MAESTROS --- */
      :root {
        --primary: #10214b;
        --secondary: #d4af37;
        --accent: #0056b3;
        --bg-light: #f4f8fb;
        --text-dark: #333;
        --border: #e0e0e0;
      }

      body {
        font-family: "Lato", sans-serif;
        background-color: var(--bg-light);
        margin: 0;
        color: var(--text-dark);
      }
      .calc-wrapper {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      /* TARJETAS */
      .calc-card {
        background: white;
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 5px 20px rgba(16, 33, 75, 0.05);
        border: 1px solid var(--border);
        margin-bottom: 25px;
      }

      /* CONFIGURACIÓN FLOTANTE */
      .config-bar {
        background: #e3f2fd;
        border: 1px solid #90caf9;
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 25px;
        display: flex;
        gap: 20px;
        align-items: center;
        flex-wrap: wrap;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
      }
      .config-label {
        font-weight: 900;
        color: #0d47a1;
        margin-right: 10px;
        display: flex;
        align-items: center;
        gap: 5px;
      }

      .section-title {
        color: var(--primary);
        font-size: 1.2rem;
        font-weight: 800;
        border-bottom: 2px solid #eee;
        padding-bottom: 10px;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      /* GRIDS FORMULARIOS */
      .form-grid-2 {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
      }
      @media (max-width: 600px) {
        .form-grid-2 {
          grid-template-columns: 1fr;
        }
      }

      .form-group label {
        display: block;
        font-weight: 700;
        color: var(--primary);
        margin-bottom: 5px;
        font-size: 0.85rem;
      }
      .form-group small {
        display: block;
        color: #666;
        font-size: 0.75rem;
        margin-bottom: 5px;
      }

      .input-group {
        position: relative;
        display: flex;
        align-items: center;
      }
      .input-icon {
        position: absolute;
        left: 12px;
        color: var(--primary);
        z-index: 10;
        opacity: 0.7;
      }

      .form-control {
        width: 100%;
        padding: 10px 10px 10px 35px;
        border: 1px solid #ccc;
        border-radius: 6px;
        font-size: 0.95rem;
        background: #fff;
        box-sizing: border-box;
        transition: all 0.3s;
      }
      .form-control:focus {
        border-color: var(--primary);
        outline: none;
        box-shadow: 0 0 0 3px rgba(16, 33, 75, 0.1);
      }
      .form-control:disabled {
        background: #f5f5f5;
        color: #999;
        cursor: not-allowed;
      }
      select.form-control {
        cursor: pointer;
        font-weight: 600;
      }

      /* CHECKBOXES */
      .check-group {
        background: #f8f9fa;
        padding: 8px 12px;
        border-radius: 6px;
        border: 1px solid #e0e0e0;
        display: flex;
        align-items: center;
        gap: 10px;
        height: 42px;
        box-sizing: border-box;
        cursor: pointer;
      }
      .check-group input {
        width: 18px;
        height: 18px;
        accent-color: var(--primary);
        cursor: pointer;
      }
      .check-group label {
        margin: 0;
        cursor: pointer;
        font-size: 0.9rem;
        flex-grow: 1;
      }

      .btn-calculate {
        background-color: var(--primary);
        color: white;
        border: none;
        width: 100%;
        padding: 16px;
        font-size: 1.1rem;
        font-weight: 900;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s;
        margin-top: 20px;
        text-transform: uppercase;
        letter-spacing: 1px;
      }
      .btn-calculate:hover {
        background-color: var(--secondary);
        transform: translateY(-2px);
      }

      /* --- ESTILOS PARA REPORTE MAGISTRAL (PDF Friendly) --- */
      #resultsContainer {
        display: none; /* Oculto al inicio */
        margin-top: 40px;
      }

      /* Importante: Sin overflow hidden para que PDF capture todo */
      .report-paper {
        background: white;
        padding: 40px;
        border-radius: 0;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        border: 1px solid #eee;
        position: relative;
      }

      /* MARCA DE AGUA */
      .watermark {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) rotate(-30deg);
        font-size: 5rem;
        font-weight: 900;
        color: #f2f2f2; /* Gris muy claro para no tapar texto */
        white-space: nowrap;
        pointer-events: none;
        z-index: 0;
        font-family: "Montserrat", sans-serif;
      }

      .report-section {
        margin-bottom: 30px;
        position: relative;
        z-index: 1;
      }

      .report-header-strip {
        background: var(--primary);
        color: var(--secondary);
        padding: 8px 20px;
        font-weight: bold;
        text-transform: uppercase;
        margin-bottom: 15px;
        border-left: 5px solid var(--secondary);
        font-size: 0.95rem;
      }

      /* DATOS DE ENTRADA EN PDF */
      .input-summary-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 15px;
        background: #f8f9fa;
        padding: 15px;
        border-radius: 6px;
        border: 1px solid #e0e0e0;
        font-size: 0.85rem;
      }
      .input-item label {
        display: block;
        color: #666;
        font-weight: bold;
        margin-bottom: 3px;
      }
      .input-item span {
        color: var(--primary);
        font-weight: 800;
        font-size: 1rem;
      }

      /* DISEÑO PESTAÑA EMPLEADOR (GRID) */
      .employer-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 30px;
      }
      @media (max-width: 800px) {
        .employer-grid {
          grid-template-columns: 1fr;
        }
      }

      .summary-box {
        background: #fff;
        border: 1px solid #eee;
        border-radius: 10px;
        padding: 20px;
        height: 100%;
        box-shadow: none;
        border: 1px solid #ddd;
      }
      .summary-header {
        color: var(--primary);
        font-weight: 800;
        border-bottom: 2px solid var(--secondary);
        padding-bottom: 10px;
        margin-bottom: 15px;
        font-size: 1.1rem;
      }

      .row-item {
        display: flex;
        justify-content: space-between;
        margin-bottom: 8px;
        font-size: 0.95rem;
        color: #555;
      }
      .row-item strong {
        color: #222;
      }

      .total-card {
        background: var(--primary);
        color: white;
        padding: 25px;
        border-radius: 10px;
        text-align: right;
        margin-top: 20px;
      }
      .total-card h3 {
        margin: 0;
        font-size: 2.2rem;
        font-weight: 900;
        color: var(--secondary);
      }

      /* TABLAS SIMPLES */
      .simple-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
      }
      .simple-table th {
        text-align: left;
        padding: 8px;
        background: #f5f5f5;
        color: #333;
        font-size: 0.85rem;
        border-bottom: 2px solid #ddd;
      }
      .simple-table td {
        padding: 8px;
        border-bottom: 1px solid #eee;
        font-size: 0.9rem;
      }
      .simple-table tr:last-child td {
        border-bottom: none;
        font-weight: bold;
      }

      .text-red {
        color: #c62828;
        font-weight: bold;
      }
      .text-green {
        color: var(--primary);
        font-weight: bold;
      }

      /* BOTÓN PDF */
      .btn-pdf {
        display: block;
        width: 280px;
        margin: 30px auto 0;
        padding: 15px;
        background: #c62828;
        color: white;
        text-align: center;
        border: none;
        border-radius: 50px;
        font-weight: bold;
        cursor: pointer;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        transition: transform 0.2s;
        text-decoration: none;
        font-size: 1rem;
      }
      .btn-pdf:hover {
        background: #b71c1c;
        transform: scale(1.05);
      }

      /* WhatsApp Float */
      .whatsapp-btn {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: #25d366;
        color: white;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 35px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        z-index: 1000;
        transition: all 0.3s ease;
        text-decoration: none;
      }
      .whatsapp-btn:hover {
        background-color: #128c7e;
        transform: scale(1.1);
      }
    </style>
  </head>
  <body>
    <div class="top-bar">
      <div class="container">
        <div class="info">
          Herramientas Jurídicas Gratuitas | Tu Abogado Laboral
        </div>
      </div>
    </div>
    <header>
      <div class="container header-container">
        <div class="logo">
          <a href="index.html"
            ><img src="img/logo-principal.webp" alt="Logo" class="logo-img"
          /></a>
        </div>
        <div class="menu-toggle" id="mobile-menu">
          <i class="fas fa-bars"></i>
        </div>
        <nav>
          <ul class="nav-menu">
            <li>
              <a href="blog.html" style="color: #10214b; font-weight: bold"
                ><i class="fas fa-arrow-left"></i> Volver a Herramientas</a
              >
            </li>
          </ul>
        </nav>
      </div>
    </header>

    <section class="bg-light" style="padding: 40px 0">
      <div class="calc-wrapper">
        <div class="text-center mb-5">
          <h1
            style="
              color: var(--primary);
              font-size: 2.2rem;
              margin-bottom: 10px;
            "
          >
            Calculadora Laboral Integrada
          </h1>
          <p style="color: #666">
            Cálculo 100% actualizado de Nómina, Costos Empresariales y
            Retención.
          </p>
        </div>

        <form id="masterForm">
          <div class="config-bar">
            <span class="config-label"
              ><i class="fas fa-calendar-check"></i> Valores 2026:</span
            >
            <div class="input-group" style="width: 150px">
              <small
                style="
                  position: absolute;
                  top: -18px;
                  left: 0;
                  font-weight: bold;
                "
                >SMMLV</small
              >
              <input
                type="number"
                id="confSalarioMin"
                class="form-control"
                value="1750905"
                style="
                  padding: 5px 10px;
                  height: 38px;
                  font-weight: bold;
                  color: var(--primary);
                "
              />
            </div>
            <div class="input-group" style="width: 150px">
              <small
                style="
                  position: absolute;
                  top: -18px;
                  left: 0;
                  font-weight: bold;
                "
                >Aux. Transporte</small
              >
              <input
                type="number"
                id="confAuxilio"
                class="form-control"
                value="249095"
                style="
                  padding: 5px 10px;
                  height: 38px;
                  font-weight: bold;
                  color: var(--primary);
                "
              />
            </div>
            <div class="input-group" style="width: 120px">
              <small
                style="
                  position: absolute;
                  top: -18px;
                  left: 0;
                  font-weight: bold;
                "
                >UVT</small
              >
              <input
                type="number"
                id="confUVT"
                class="form-control"
                value="52374"
                style="
                  padding: 5px 10px;
                  height: 38px;
                  font-weight: bold;
                  color: var(--primary);
                "
              />
            </div>
          </div>

          <div class="form-grid-2">
            <div class="calc-card">
              <h3 class="section-title">
                <i class="fas fa-user-clock"></i> Datos del Contrato
              </h3>

              <div class="form-group">
                <label>Tipo de Vinculación</label>
                <div class="input-group">
                  <i class="fas fa-file-contract input-icon"></i>
                  <select id="tipoContrato" class="form-control">
                    <option value="fijo">Contrato a Término Fijo</option>
                    <option value="indefinido" selected>
                      Contrato a Término Indefinido
                    </option>
                    <option value="obra">Contrato por Obra o Labor</option>
                    <option value="servicios">
                      Contrato de Prestación de Servicios
                    </option>
                  </select>
                </div>
              </div>

              <div class="form-group">
                <label for="salarioBase">Salario Base Mensual</label>
                <div class="input-group">
                  <i class="fas fa-dollar-sign input-icon"></i>
                  <input
                    type="number"
                    id="salarioBase"
                    class="form-control"
                    placeholder="Ej: 3000000"
                    required
                  />
                </div>
              </div>

              <div class="form-group">
                <label for="diasLaborados">Días a Liquidar</label>
                <div class="input-group">
                  <i class="fas fa-calendar-day input-icon"></i>
                  <input
                    type="number"
                    id="diasLaborados"
                    class="form-control"
                    value="30"
                    min="1"
                    max="30"
                    required
                  />
                </div>
                <small>Por defecto 30 (mes completo).</small>
              </div>

              <div class="form-group" id="grpAuxilio">
                <label>Auxilio de Transporte</label>
                <div style="display: flex; gap: 10px">
                  <div class="check-group" style="flex: 0 0 auto">
                    <input type="checkbox" id="checkAux" />
                    <label for="checkAux">Incluir</label>
                  </div>
                  <input
                    type="number"
                    id="valAuxilioInput"
                    class="form-control"
                    placeholder="Valor Auxilio"
                    disabled
                    style="background: #f9f9f9"
                  />
                </div>
                <small
                  >Se marca automáticamente si el salario base es <= 2
                  SMMLV.</small
                >
              </div>

              <div class="form-group">
                <label>Otros Ingresos (Bonos/Comisiones)</label>
                <div class="input-group">
                  <i class="fas fa-plus-circle input-icon"></i>
                  <input
                    type="number"
                    id="otrosIngresos"
                    class="form-control"
                    placeholder="0"
                  />
                </div>
              </div>
            </div>

            <div class="calc-card">
              <h3 class="section-title">
                <i class="fas fa-building"></i> Configuración Avanzada
              </h3>

              <div id="panelLaboral">
                <div class="form-group">
                  <label>Exoneración Aportes (Empresa)</label>
                  <div class="input-group">
                    <i class="fas fa-hand-holding-usd input-icon"></i>
                    <select id="selectExonerado" class="form-control">
                      <option value="no" selected>No Exonerada</option>
                      <option value="si">Exonerada (Ley 1607)</option>
                    </select>
                  </div>
                </div>
                <div class="form-grid-2">
                  <div class="form-group">
                    <label>Riesgo ARL</label>
                    <select id="nivelArl" class="form-control">
                      <option value="0.00522">I (0.522%)</option>
                      <option value="0.01044">II (1.044%)</option>
                      <option value="0.02436">III (2.436%)</option>
                      <option value="0.04350">IV (4.350%)</option>
                      <option value="0.06960">V (6.960%)</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label>Ley Pensional (FSP)</label>
                    <select id="leyPensional" class="form-control">
                      <option value="ley100">Ley 100</option>
                      <option value="ley2381" selected>
                        Ley 2381 (Reforma)
                      </option>
                    </select>
                  </div>
                </div>
              </div>

              <div
                style="
                  background: #f0f7ff;
                  padding: 15px;
                  border-radius: 8px;
                  margin-top: 15px;
                  border: 1px dashed #bbdefb;
                "
              >
                <label
                  style="
                    color: #0d47a1;
                    margin-bottom: 10px;
                    display: block;
                    font-size: 0.9rem;
                    font-weight: bold;
                  "
                  ><i class="fas fa-calculator"></i> Datos para Retención en la
                  Fuente</label
                >
                <div class="form-grid-2">
                  <div class="form-group">
                    <small>Medicina Prepagada</small>
                    <input
                      type="number"
                      id="dedPrepagada"
                      class="form-control"
                      placeholder="0"
                    />
                  </div>
                  <div class="form-group">
                    <small>Dependientes</small>
                    <div class="check-group" style="height: 38px">
                      <input type="checkbox" id="checkDependientes" />
                      <label for="checkDependientes">Sí (10%)</label>
                    </div>
                  </div>
                  <div class="form-group">
                    <small>Intereses Vivienda</small>
                    <input
                      type="number"
                      id="dedVivienda"
                      class="form-control"
                      placeholder="0"
                    />
                  </div>
                  <div class="form-group">
                    <small>Aportes Voluntarios</small>
                    <input
                      type="number"
                      id="dedVoluntarios"
                      class="form-control"
                      placeholder="0"
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>

          <button type="submit" class="btn-calculate" id="btnCalcular">
            <i class="fas fa-check-circle"></i> Calcular Todo
          </button>
        </form>

        <div id="resultsContainer">
          <div class="report-paper" id="printArea">
            <div class="watermark">TU ABOGADO LABORAL</div>

            <div style="text-align: center; margin-bottom: 30px">
              <img
                src="img/logo-principal.webp"
                alt="Logo"
                style="height: 60px; margin-bottom: 10px"
                onerror="this.style.display = 'none'"
              />
              <h2 style="color: var(--primary); margin: 0">
                INFORME DETALLADO DE NÓMINA
              </h2>
              <p style="color: #666; font-size: 0.9rem">
                Proyección Jurídica y Contable 2026
              </p>
            </div>

            <div class="report-section">
              <div class="report-header-strip">0. Datos de Liquidación</div>
              <div class="input-summary-grid">
                <div class="input-item">
                  <label>Salario Base:</label>
                  <span id="pSalarioBase">$0</span>
                </div>
                <div class="input-item">
                  <label>Días Liq:</label>
                  <span id="pDiasLiq">30</span>
                </div>
                <div class="input-item">
                  <label>Tipo Contrato:</label>
                  <span id="pTipoContrato" style="text-transform: capitalize"
                    >--</span
                  >
                </div>
                <div class="input-item">
                  <label>Auxilio Transporte:</label>
                  <span id="pAuxilioIncluido">$0</span>
                </div>
                <div class="input-item">
                  <label>Otros Ingresos:</label>
                  <span id="pOtrosIngresos">$0</span>
                </div>
                <div class="input-item">
                  <label>Exoneración Ley 1607:</label>
                  <span id="pExonerado">--</span>
                </div>
                <div class="input-item">
                  <label>Riesgo ARL:</label>
                  <span id="pRiesgoArl">--</span>
                </div>
              </div>
            </div>

            <div class="report-section">
              <div class="report-header-strip">1. Nómina Empleado</div>

              <div
                class="calc-card"
                style="
                  border-top: 4px solid var(--secondary);
                  border: 1px solid #eee;
                  box-shadow: none;
                "
              >
                <div class="form-grid-2">
                  <div>
                    <h4 class="text-green">
                      <i class="fas fa-plus-circle"></i> DEVENGADO
                    </h4>
                    <table class="simple-table">
                      <tr>
                        <td>Salario Básico (Periodo)</td>
                        <td id="eSalario" style="text-align: right">$0</td>
                      </tr>
                      <tr>
                        <td>Aux. Transporte</td>
                        <td id="eAuxilio" style="text-align: right">$0</td>
                      </tr>
                      <tr>
                        <td>Otros/Bonos</td>
                        <td id="eOtros" style="text-align: right">$0</td>
                      </tr>
                      <tr style="background: #e8f5e9">
                        <td><strong>TOTAL DEVENGADO</strong></td>
                        <td
                          id="eTotalDev"
                          style="text-align: right; font-weight: bold"
                        >
                          $0
                        </td>
                      </tr>
                    </table>
                  </div>
                  <div>
                    <h4 class="text-red">
                      <i class="fas fa-minus-circle"></i> DEDUCCIONES
                    </h4>
                    <table class="simple-table">
                      <tr>
                        <td>Salud (4%)</td>
                        <td id="eSalud" style="text-align: right">$0</td>
                      </tr>
                      <tr>
                        <td>Pensión (4%)</td>
                        <td id="ePension" style="text-align: right">$0</td>
                      </tr>
                      <tr>
                        <td>Fondo Solidaridad</td>
                        <td id="eFsp" style="text-align: right">$0</td>
                      </tr>
                      <tr>
                        <td>Retención Fuente</td>
                        <td id="eRetefuente" style="text-align: right">$0</td>
                      </tr>
                      <tr style="background: #ffebee">
                        <td><strong>TOTAL DEDUCCIONES</strong></td>
                        <td
                          id="eTotalDed"
                          style="text-align: right; font-weight: bold"
                        >
                          $0
                        </td>
                      </tr>
                    </table>
                  </div>
                </div>
                <div
                  style="
                    background: #fdfbf5;
                    padding: 20px;
                    text-align: right;
                    border-radius: 8px;
                    margin-top: 30px;
                    border: 1px solid var(--secondary);
                  "
                >
                  <span
                    style="
                      font-size: 1.1rem;
                      font-weight: bold;
                      color: var(--primary);
                    "
                    >NETO A PAGAR AL EMPLEADO:</span
                  >
                  <div
                    id="eNeto"
                    style="
                      font-size: 2.5rem;
                      font-weight: 900;
                      color: var(--secondary);
                    "
                  >
                    $0
                  </div>
                </div>
              </div>
            </div>

            <div class="report-section">
              <div
                style="
                  border-left: 3px solid var(--primary);
                  padding-left: 15px;
                  margin-bottom: 10px;
                "
              >
                <h4 style="margin: 0; color: #555">
                  <i class="fas fa-info-circle"></i> Anexo: Cálculo Retención en
                  la Fuente
                </h4>
              </div>
              <div
                style="background: #f9f9f9; padding: 20px; border-radius: 8px"
              >
                <table class="simple-table">
                  <tr>
                    <th>Concepto Depuración</th>
                    <th style="text-align: right">Valor</th>
                  </tr>
                  <tr>
                    <td>(+) Ingresos Totales</td>
                    <td id="rIngresos" style="text-align: right">$0</td>
                  </tr>
                  <tr>
                    <td>(-) Aportes Seguridad Social</td>
                    <td
                      id="rSeguridad"
                      style="text-align: right; color: #c62828"
                    >
                      $0
                    </td>
                  </tr>
                  <tr>
                    <td><strong>(=) Ingreso Neto</strong></td>
                    <td id="rNeto" style="text-align: right; font-weight: bold">
                      $0
                    </td>
                  </tr>
                  <tr>
                    <td>(-) Deducciones Totales</td>
                    <td
                      id="rDeducciones"
                      style="text-align: right; color: #c62828"
                    >
                      $0
                    </td>
                  </tr>
                  <tr>
                    <td>(-) Rentas Exentas</td>
                    <td id="rExentas" style="text-align: right; color: #c62828">
                      $0
                    </td>
                  </tr>
                  <tr style="background: #e3f2fd">
                    <td><strong>(=) BASE GRAVABLE FINAL</strong></td>
                    <td
                      id="rBase"
                      style="
                        text-align: right;
                        font-weight: bold;
                        color: var(--primary);
                      "
                    >
                      $0
                    </td>
                  </tr>
                  <tr>
                    <td><strong>IMPUESTO A RETENER (DIAN)</strong></td>
                    <td
                      id="rTotal"
                      style="
                        text-align: right;
                        font-weight: 900;
                        color: var(--primary);
                        font-size: 1.1rem;
                      "
                    >
                      $0
                    </td>
                  </tr>
                </table>
              </div>
            </div>

            <div class="report-section">
              <div class="report-header-strip">2. Costos del Empleador</div>

              <div class="employer-grid">
                <div class="summary-box">
                  <div class="summary-header">Salario y Seguridad Social</div>

                  <div class="row-item">
                    <span>Salario Base (Dev):</span>
                    <strong id="cSalario">$0</strong>
                  </div>
                  <div class="row-item">
                    <span>Auxilio Transporte:</span>
                    <strong id="cAuxilio">$0</strong>
                  </div>
                  <div class="row-item">
                    <span>Dotación (Prov):</span> <span id="cDotacion">$0</span>
                  </div>
                  <div
                    class="row-item"
                    style="
                      border-top: 1px dashed #ccc;
                      margin-top: 10px;
                      padding-top: 10px;
                    "
                  >
                    <span>Salud (8.5%):</span> <strong id="cSalud">$0</strong>
                  </div>
                  <div class="row-item">
                    <span>Pensión (12%):</span>
                    <strong id="cPension">$0</strong>
                  </div>
                  <div class="row-item">
                    <span>ARL:</span> <strong id="cArl">$0</strong>
                  </div>
                </div>

                <div class="summary-box">
                  <div class="summary-header">Parafiscales y Prestaciones</div>

                  <div class="row-item">
                    <span>Caja Compensación (4%):</span>
                    <strong id="cCaja">$0</strong>
                  </div>
                  <div class="row-item">
                    <span>ICBF (3%):</span> <strong id="cIcbf">$0</strong>
                  </div>
                  <div class="row-item">
                    <span>SENA (2%):</span> <strong id="cSena">$0</strong>
                  </div>

                  <div
                    class="row-item"
                    style="
                      border-top: 1px dashed #ccc;
                      margin-top: 10px;
                      padding-top: 10px;
                    "
                  >
                    <span>Prima de Servicios:</span>
                    <strong id="cPrima">$0</strong>
                  </div>
                  <div class="row-item">
                    <span>Cesantías:</span> <strong id="cCesantias">$0</strong>
                  </div>
                  <div class="row-item">
                    <span>Int. Cesantías:</span>
                    <strong id="cIntereses">$0</strong>
                  </div>
                  <div class="row-item">
                    <span>Vacaciones:</span>
                    <strong id="cVacaciones">$0</strong>
                  </div>
                </div>
              </div>

              <div class="total-card">
                <span style="opacity: 0.8; font-size: 1rem"
                  >COSTO TOTAL DEL PERIODO PARA LA EMPRESA</span
                >
                <h3 id="cTotalMensual">$0</h3>
                <div style="font-size: 0.9rem; margin-top: 5px; opacity: 0.9">
                  Costo Anual Proyectado: <strong id="cTotalAnual">$0</strong>
                </div>
              </div>
            </div>

            <p
              style="
                text-align: center;
                margin-top: 30px;
                font-size: 0.8rem;
                color: #888;
              "
            >
              * Herramienta auditada bajo normativa laboral colombiana
              proyectada para 2026. <br />
              * Documento generado automáticamente por Tu Abogado Laboral.
            </p>
          </div>

          <button onclick="downloadPDF()" class="btn-pdf">
            <i class="fas fa-file-pdf"></i> Descargar PDF Oficial
          </button>
        </div>
      </div>
    </section>

    <div class="container" style="max-width: 1000px; margin: 0 auto">
      <div
        style="
          background-color: #fff;
          border-top: 3px solid #d4af37;
          padding: 20px;
          margin: 40px 0 20px 0;
          border-radius: 4px;
          box-shadow: 0 2px 10px rgba(0, 0, 0, 0.03);
          text-align: center;
          font-size: 0.85rem;
          color: #666;
          line-height: 1.5;
        "
      >
        <p style="margin: 0">
          <strong style="color: #10214b">Aviso Legal:</strong>
          Esta herramienta realiza proyecciones basadas en la normativa laboral
          vigente en Colombia. Los resultados son
          <strong>aproximaciones ilustrativas</strong> y pueden variar según
          convenciones colectivas o interpretaciones judiciales. El uso de este
          simulador no crea una relación abogado-cliente ni sustituye una
          liquidación oficial.
          <span style="display: block; margin-top: 5px; font-style: italic">
            Tu Abogado Laboral no se hace responsable por decisiones tomadas
            basándose exclusivamente en estos datos.
          </span>
        </p>
      </div>
    </div>

    <footer>
      <div class="container">
        <div class="footer-grid">
          <div class="footer-col">
            <div class="footer-logo">Tu Abogado <span>Laboral</span></div>
            <p style="color: #ccc; margin-bottom: 20px; font-size: 0.9rem">
              Defensa experta y estratégica en Derecho Laboral y Pensional.
              Barranquilla, Colombia.
            </p>
            <div class="social-icons-footer">
              <a
                href="https://web.facebook.com/profile.php?id=100064878228146"
                target="_blank"
                ><i class="fab fa-facebook-f"></i
              ></a>
              <a
                href="https://www.instagram.com/tuabogadolaboralbq/"
                target="_blank"
                ><i class="fab fa-instagram"></i
              ></a>
              <a
                href="https://www.linkedin.com/in/dra-johana-manga-padilla-5745b542/"
                target="_blank"
                ><i class="fab fa-linkedin-in"></i
              ></a>
            </div>
          </div>

          <div class="footer-col links-col">
            <h4>Enlaces Rápidos</h4>
            <ul>
              <li><a href="index.html">Inicio</a></li>
              <li><a href="nosotros.html">Sobre Nosotros</a></li>
              <li><a href="servicios.html">Áreas de Práctica</a></li>
              <li><a href="blog.html">Herramientas</a></li>
              <li>
                <a href="contacto.html" class="active-footer">Agendar Cita</a>
              </li>
            </ul>
          </div>

          <div class="footer-col">
            <h4>Contacto</h4>
            <ul class="contact-list">
              <li>
                <i class="fas fa-map-marker-alt"></i
                ><span
                  >Edificio Las Flores, Calle 39 #43-123, Barranquilla</span
                >
              </li>
              <li>
                <i class="fas fa-phone-alt"></i><span>+57 321 792 7495</span>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <div class="container copyright-flex">
          <p>© 2026 Tu Abogado Laboral - Todos los derechos reservados.</p>
          <a href="politica-privacidad.html" class="privacy-link"
            >Política de Privacidad</a
          >
        </div>
      </div>
    </footer>

    <a
      href="https://wa.me/573217927495"
      class="whatsapp-btn"
      target="_blank"
      title="Contáctanos por WhatsApp"
    >
      <i class="fab fa-whatsapp"></i>
    </a>

    <script>
      const formatoPeso = new Intl.NumberFormat("es-CO", {
        style: "currency",
        currency: "COP",
        minimumFractionDigits: 0,
        maximumFractionDigits: 0,
      });

      // --- FUNCIÓN PDF ROBUSTA (Solución a hoja blanca) ---
      function downloadPDF() {
        const element = document.getElementById("printArea");

        // Configuración para asegurar que todo se capture
        const opt = {
          margin: [0.3, 0.3, 0.3, 0.3], // Márgenes pequeños
          filename: "Liquidacion_Nomina_TuAbogadoLaboral.pdf",
          image: { type: "jpeg", quality: 0.98 },
          html2canvas: {
            scale: 2, // Mejora calidad texto
            useCORS: true, // Permite cargar imágenes externas
            scrollY: 0, // Clave: Ignora el scroll actual para capturar todo
            logging: true,
          },
          jsPDF: {
            unit: "in",
            format: "letter",
            orientation: "portrait",
          },
        };

        // Generar PDF
        html2pdf().set(opt).from(element).save();
      }

      // --- INTERACCIÓN UI ---
      const tipoContrato = document.getElementById("tipoContrato");
      const checkAux = document.getElementById("checkAux");
      const valAuxInput = document.getElementById("valAuxilioInput");
      const confAuxilio = document.getElementById("confAuxilio");
      const salarioBaseInput = document.getElementById("salarioBase");
      const confSalarioMin = document.getElementById("confSalarioMin");

      // Control Auxilio: Desmarcado por defecto
      checkAux.addEventListener("change", function () {
        if (this.checked) {
          valAuxInput.disabled = false;
          valAuxInput.value = confAuxilio.value;
        } else {
          valAuxInput.disabled = true;
          valAuxInput.value = "";
        }
      });

      // LÓGICA: AUTO-DETECTAR AUXILIO TRANSPORTE
      function autoValidarAuxilio() {
        const salario = parseFloat(salarioBaseInput.value) || 0;
        const smmlv = parseFloat(confSalarioMin.value) || 0;
        const esServicios = tipoContrato.value === "servicios";
        const tope = smmlv * 2;

        if (!esServicios && salario > 0) {
          if (salario <= tope) {
            checkAux.checked = true;
          } else {
            checkAux.checked = false;
          }
          checkAux.dispatchEvent(new Event("change"));
        }
      }

      salarioBaseInput.addEventListener("input", autoValidarAuxilio);

      // Control Tipo Contrato
      tipoContrato.addEventListener("change", function () {
        const esServicios = this.value === "servicios";
        const panelLaboral = document.getElementById("panelLaboral");

        if (esServicios) {
          panelLaboral.style.opacity = "0.3";
          panelLaboral.style.pointerEvents = "none";
          document.querySelector("label[for='salarioBase']").textContent =
            "Honorarios Mensuales";
          checkAux.checked = false;
          checkAux.dispatchEvent(new Event("change"));
          checkAux.disabled = true;
        } else {
          panelLaboral.style.opacity = "1";
          panelLaboral.style.pointerEvents = "auto";
          document.querySelector("label[for='salarioBase']").textContent =
            "Salario Base Mensual";
          checkAux.disabled = false;
          autoValidarAuxilio();
        }
      });

      // --- LÓGICA DE CÁLCULO ---
      document
        .getElementById("masterForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          // 1. Feedback Visual: Cambiar texto botón
          const btn = document.getElementById("btnCalcular");
          const originalText = btn.innerHTML;
          btn.innerHTML =
            '<i class="fas fa-spinner fa-spin"></i> Calculando...';

          try {
            // FUNCIÓN SEGURA PARA ESCRIBIR EN HTML (Para evitar el error "null")
            const setText = (id, val) => {
              const el = document.getElementById(id);
              if (el) {
                el.textContent = val;
              }
            };

            const getVal = (id) =>
              parseFloat(document.getElementById(id).value) || 0;

            // PARÁMETROS
            const SMMLV = getVal("confSalarioMin");
            const UVT = getVal("confUVT");
            const salarioContrato = getVal("salarioBase");
            const dias = getVal("diasLaborados");
            const otros = getVal("otrosIngresos");
            const tipo = tipoContrato.value;

            // 1. CÁLCULO PROPORCIONAL
            // Salario real ganado en los días
            const salarioDevengado = (salarioContrato / 30) * dias;

            // Auxilio real ganado en los días (si aplica)
            const valAuxLegal = parseFloat(confAuxilio.value) || 0;
            let auxilioDevengado = 0;
            if (checkAux.checked) {
              auxilioDevengado = (valAuxLegal / 30) * dias;
            }

            // RELLENAR DATOS DE ENTRADA EN EL PDF (NUEVO)
            setText("pSalarioBase", formatoPeso.format(salarioContrato));
            setText("pDiasLiq", dias);
            setText(
              "pTipoContrato",
              tipo === "indefinido"
                ? "Término Indefinido"
                : tipo === "fijo"
                  ? "Término Fijo"
                  : tipo === "obra"
                    ? "Obra o Labor"
                    : "Prestación Servicios",
            );
            setText(
              "pAuxilioIncluido",
              auxilioDevengado > 0
                ? formatoPeso.format(auxilioDevengado)
                : "No Aplica ($0)",
            );
            setText("pOtrosIngresos", formatoPeso.format(otros));

            // CONFIG EMPRESA
            const arlPct = parseFloat(
              document.getElementById("nivelArl").value,
            );
            setText("pRiesgoArl", (arlPct * 100).toFixed(3) + "%");

            let exonerado = false;
            let txtExonerado = "No (Paga Todo)";
            if (tipo !== "servicios") {
              exonerado =
                document.getElementById("selectExonerado").value === "si";
              if (salarioContrato + otros >= SMMLV * 10) {
                exonerado = false;
                txtExonerado = "No (Supera 10 SMMLV)";
              } else if (exonerado) {
                txtExonerado = "Sí (Aplica)";
              }
            } else {
              txtExonerado = "N/A (Independiente)";
            }
            setText("pExonerado", txtExonerado);

            // CONFIG TRIBUTARIA
            const prepagada = Math.min(getVal("dedPrepagada"), 16 * UVT);
            const vivienda = Math.min(getVal("dedVivienda"), 100 * UVT);
            const voluntarios = getVal("dedVoluntarios");
            const dependientes = document.getElementById("checkDependientes")
              .checked
              ? Math.min((salarioDevengado + otros) * 0.1, 32 * UVT)
              : 0;
            const leyFsp = document.getElementById("leyPensional").value;

            // VARIABLES
            let empSalud = 0,
              empPension = 0,
              empFsp = 0;
            let ciaSalud = 0,
              ciaPension = 0,
              ciaArl = 0,
              ciaCaja = 0,
              ciaSena = 0,
              ciaIcbf = 0;
            let ciaPrima = 0,
              ciaCesantias = 0,
              ciaInt = 0,
              ciaVacaciones = 0;

            // CÁLCULOS SOBRE LO DEVENGADO
            let baseSS = salarioDevengado + otros;

            if (tipo === "servicios") {
              // OPS
            } else {
              // Empleado
              empSalud = baseSS * 0.04;
              empPension = baseSS * 0.04;

              // FSP
              if (salarioContrato + otros > SMMLV * 4) {
                let pct = 0;
                let nS = (salarioContrato + otros) / SMMLV;
                if (leyFsp === "ley100") {
                  pct =
                    nS < 16
                      ? 1.0
                      : nS < 17
                        ? 1.2
                        : nS < 18
                          ? 1.4
                          : nS < 19
                            ? 1.6
                            : nS < 20
                              ? 1.8
                              : 2.0;
                } else {
                  if (nS < 7) pct = 1.5;
                  else if (nS < 11) pct = 1.8;
                  else if (nS < 19) pct = 2.5;
                  else if (nS <= 20) pct = 2.8;
                  else pct = 3.0;
                }
                empFsp = baseSS * (pct / 100);
              }

              // Empresa
              ciaSalud = exonerado ? 0 : baseSS * 0.085;
              ciaPension = baseSS * 0.12;
              ciaArl = baseSS * arlPct;
              ciaCaja = baseSS * 0.04;
              ciaSena = exonerado ? 0 : baseSS * 0.02;
              ciaIcbf = exonerado ? 0 : baseSS * 0.03;

              let basePrest = salarioDevengado + otros + auxilioDevengado;
              ciaPrima = basePrest * 0.0833;
              ciaCesantias = basePrest * 0.0833;
              ciaInt = basePrest * 0.01;
              let baseVac = salarioDevengado + otros;
              ciaVacaciones = baseVac * 0.0417;
            }

            // --- RETENCIÓN AJUSTADA (PROYECCIÓN MENSUAL) ---
            let totalIncr = 0;
            if (tipo === "servicios") {
              let ibc = (salarioDevengado + otros) * 0.4;
              totalIncr = ibc * 0.125 + ibc * 0.16 + ibc * 0.00522;
            } else {
              totalIncr = empSalud + empPension + empFsp;
            }

            let netoDepuracion = salarioDevengado + otros - totalIncr;

            let totalDeducciones = vivienda + prepagada + dependientes;

            let base25 = Math.max(
              0,
              netoDepuracion - totalDeducciones - voluntarios,
            );
            let renta25 = base25 * 0.25;
            let totalAlivios = totalDeducciones + voluntarios + renta25;

            // Topes de ley (Mensuales)
            let tope40 = netoDepuracion * 0.4;
            let topeAbs = (1340 / 12) * UVT; // 1340 UVT anuales / 12
            let realAlivios = Math.min(totalAlivios, Math.min(tope40, topeAbs));

            let baseGravableReal = Math.max(0, netoDepuracion - realAlivios);

            // AQUÍ LA CORRECCIÓN: Proyectar a 30 días para buscar en la tabla
            let baseGravableProyectada = (baseGravableReal / dias) * 30;
            let baseUVT = baseGravableProyectada / UVT;

            let retUVT = 0;
            if (baseUVT > 2300) retUVT = (baseUVT - 2300) * 0.39 + 770;
            else if (baseUVT > 945) retUVT = (baseUVT - 945) * 0.37 + 268;
            else if (baseUVT > 640) retUVT = (baseUVT - 640) * 0.35 + 162;
            else if (baseUVT > 360) retUVT = (baseUVT - 360) * 0.33 + 69;
            else if (baseUVT > 150) retUVT = (baseUVT - 150) * 0.28 + 10;
            else if (baseUVT > 95) retUVT = (baseUVT - 95) * 0.19;

            // Impuesto mensual teórico
            let valRetencionMensual = Math.round((retUVT * UVT) / 1000) * 1000;

            // Impuesto prorrateado a los días trabajados
            let valRetencion = (valRetencionMensual / 30) * dias;

            // RENDERIZADO (Usando setText para evitar errores)
            setText("cSalario", formatoPeso.format(salarioDevengado));
            setText("cAuxilio", formatoPeso.format(auxilioDevengado));
            setText("cDotacion", tipo === "servicios" ? "$0" : "S/D");
            setText("cSalud", formatoPeso.format(ciaSalud));
            setText("cPension", formatoPeso.format(ciaPension));
            setText("cArl", formatoPeso.format(ciaArl));
            setText("cCaja", formatoPeso.format(ciaCaja));
            setText("cIcbf", formatoPeso.format(ciaIcbf));
            setText("cSena", formatoPeso.format(ciaSena));
            setText("cPrima", formatoPeso.format(ciaPrima));
            setText("cCesantias", formatoPeso.format(ciaCesantias));
            setText("cIntereses", formatoPeso.format(ciaInt));
            setText("cVacaciones", formatoPeso.format(ciaVacaciones));

            let totalEmpresa =
              salarioDevengado +
              otros +
              auxilioDevengado +
              ciaSalud +
              ciaPension +
              ciaArl +
              ciaCaja +
              ciaIcbf +
              ciaSena +
              ciaPrima +
              ciaCesantias +
              ciaInt +
              ciaVacaciones;

            if (tipo === "servicios") totalEmpresa = salarioDevengado + otros;

            // 1. Mostrar Total del Periodo (Lo que paga la empresa en esos días)
            setText("cTotalMensual", formatoPeso.format(totalEmpresa));

            // 2. CORRECCIÓN PROYECCIÓN ANUAL (Fórmula exacta):
            // (Costo del Periodo ÷ Días Trabajados) × 360 días
            let costoAnual = (totalEmpresa / dias) * 360;

            setText("cTotalAnual", formatoPeso.format(costoAnual));

            let devengado = salarioDevengado + otros + auxilioDevengado;
            setText("eSalario", formatoPeso.format(salarioDevengado));
            setText("eAuxilio", formatoPeso.format(auxilioDevengado));
            setText("eOtros", formatoPeso.format(otros));
            setText("eTotalDev", formatoPeso.format(devengado));

            setText("eSalud", formatoPeso.format(empSalud));
            setText("ePension", formatoPeso.format(empPension));
            setText("eFsp", formatoPeso.format(empFsp));
            setText("eRetefuente", formatoPeso.format(valRetencion));

            let dedTotal = empSalud + empPension + empFsp + valRetencion;
            if (tipo === "servicios") dedTotal = valRetencion;

            setText("eTotalDed", formatoPeso.format(dedTotal));
            setText("eNeto", formatoPeso.format(devengado - dedTotal));

            setText("rIngresos", formatoPeso.format(salarioDevengado + otros));
            setText("rSeguridad", "-" + formatoPeso.format(totalIncr));
            setText("rNeto", formatoPeso.format(netoDepuracion));
            setText("rDeducciones", "-" + formatoPeso.format(totalDeducciones));
            setText(
              "rExentas",
              "-" + formatoPeso.format(renta25 + voluntarios),
            );
            setText("rBase", formatoPeso.format(baseGravableReal));
            setText("rTotal", formatoPeso.format(valRetencion));

            // MOSTRAR
            const results = document.getElementById("resultsContainer");
            results.style.display = "block";
            results.scrollIntoView({ behavior: "smooth" });
          } catch (error) {
            console.error("Error en cálculo:", error);
            alert("Error de cálculo: " + error.message);
          } finally {
            // Restaurar botón
            setTimeout(() => {
              btn.innerHTML = originalText;
            }, 500);
          }
        });
    </script>
  </body>
</html>
